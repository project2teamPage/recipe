<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>레시피 작성</title>
    <link rel="stylesheet" th:href="@{/css/recipe/recipe.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
    <script th:src="@{javascript/recipe/detail.js}"></script>

    <script>
        let stepCount = 0;

        // 초기 3단계 렌더링
        window.onload = function () {
          for (let i = 0; i < 3; i++) {
            addStep();
          }
        };

        function addStep() {
          const container = document.getElementById("stepsContainer");

          const stepDiv = document.createElement("div");
          stepDiv.className = "recipe-step";
          stepDiv.innerHTML = `
            <h4>STEP ${stepCount + 1}</h4>
            <div>
              <label>이미지:</label>
              <input type="file" name="recipeStepDtoList[${stepCount}].imageFile" accept="image/*" />
            </div>
            <div>
              <label>제목:</label>
              <input type="text" name="recipeStepDtoList[${stepCount}].title" placeholder="예: 양파 볶기" />
            </div>
            <div>
              <label>내용:</label>
              <textarea name="recipeStepDtoList[${stepCount}].description" placeholder="설명을 입력하세요."></textarea>
            </div>
            <hr/>
          `;
          container.appendChild(stepDiv);
          stepCount++;
        }
    </script>


</head>
<body>
<div class="container mt-5">

    <form th:action="@{/recipe/new}" th:object="${recipeCreateDto}" method="post" enctype="multipart/form-data">

        <!-- 제목 -->
        <div class="text-center mb-4">
            <h2>제목을 입력해주세요.</h2>
                <input type="text" class="form-control" th:field="*{title}" placeholder="예) 고소한 크림 파스타">
        </div>

        <!-- 카테고리 선택 -->
        <div class="row mb-4">
            <div class="col">
                <label>음식 카테고리</label>
                <select class="form-select" th:field="*{dishType}">
                    <option value="">선택해주세요</option>
                    <option value="MAINDISH">메인요리</option>
                    <option value="SIDEDISH">반찬</option>
                    <option value="DESSERT">디저트</option>
                    <option value="DRINK">음료</option>
                </select>
            </div>
            <div class="col">
                <label>테마</label>
                <select class="form-select" th:field="*{theme}">
                    <option value="">선택해주세요</option>
                    <option value="DIET">다이어트</option>
                    <option value="SLOW_AGING">저속노화</option>
                    <option value="VEGAN">채식주의</option>
                    <option value="LOW_SUGAR">저당</option>
                    <option value="HIGH_PROTEIN">고단백</option>
                    <option value="LCHF">저탄고지</option>
                </select>
            </div>
        </div>

        <div id="stepsContainer">

        </div>


        <!-- 추가 버튼 -->
        <div class="text-center mb-4">
            <button type="button" class="btn btn-outline-secondary">+ 추가하기</button>
        </div>

        <button type="button" onclick="addStep()">+ 단계 추가</button>


        <!-- 재료 입력 -->
        <div class="mb-4">
            <label>사용한 재료</label>
            <div class="row">
                <div class="col">
                    <input type="text" class="form-control" placeholder="예: 방어회">
                </div>
                <div class="col">
                    <input type="text" class="form-control" placeholder="예: 100g">
                </div>
                <div class="col-auto">
                    <button type="button" class="btn btn-outline-primary">등록</button>
                </div>
            </div>
            <!-- 여기에 동적으로 등록된 재료 목록이 나열될 예정 -->
            <div class="mt-2">
                <span class="badge bg-light text-dark me-2">방어회 1개</span>
                <span class="badge bg-light text-dark me-2">유부 1봉지</span>
            </div>
        </div>

        <!-- 난이도 / 조리시간 -->
        <div class="row mb-4">
            <div class="col">
                <label>난이도</label>
                <div>
                    <label class="me-2"><input type="radio" name="difficulty" value="EASY"> 하</label>
                    <label class="me-2"><input type="radio" name="difficulty" value="NORMAL"> 중</label>
                    <label class="me-2"><input type="radio" name="difficulty" value="HARD"> 상</label>
                </div>
            </div>
            <div class="col">
                <label>조리시간</label>
                <input type="text" class="form-control" th:field="*{recipeTime}" placeholder="예: 30분">
            </div>
        </div>

        <!-- 버튼 -->
        <div class="text-end">
            <button type="submit" class="btn btn-outline-secondary me-2">임시 저장</button>
            <button type="submit" class="btn btn-primary">업로드</button>
        </div>
    </form>
</div>
</body>
</html>
